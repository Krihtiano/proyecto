<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="TorneigIGrups" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="e282f3c2-af66-4170-9323-1663be128b7c">
	<property name="ireport.zoom" value="1.3310000000000004"/>
	<property name="ireport.x" value="0"/>
<<<<<<< HEAD
	<property name="ireport.y" value="71"/>
=======
	<property name="ireport.y" value="74"/>
>>>>>>> d1b35c8d5be8b5c75e21623d49495d6ec59ed8e3
	<property name="ireport.jasperserver.reportUnit" value="/m2-clopez/Reports/TorneigIGrups"/>
	<property name="ireport.jasperserver.url" value="http://92.222.27.83:8080/jasperserver/services/repository"/>
	<parameter name="torneigId" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
     ( SELECT count(*) FROM `partida` paux WHERE (paux.guanyador = 'A' and paux.inscrit_a = soci.id) or (paux.guanyador = 'B' and paux.inscrit_b = soci.id) ) as 'qtat_victories',
     inscrit.`soci_id` AS inscrit_soci_id,
     inscrit.`torneig_id` AS inscrit_torneig_id,
     inscrit.`grup_num` AS inscrit_grup_num,
     inscrit.`data` AS inscrit_data,
     soci.`id` AS soci_id,
     soci.`nif` AS soci_nif,
     soci.`nom` AS soci_nom,
     soci.`cognom1` AS soci_cognom1,
     soci.`cognom2` AS soci_cognom2,
     torneig.`id` AS torneig_id,
     torneig.`nom` AS torneig_nom,
     torneig.`modalitat_id` AS torneig_modalitat_id,
     grup.`num` AS grup_num,
     grup.`description` AS grup_description,
     grup.`torneig_id` AS grup_torneig_id,
     torneig.`data_inici` AS torneig_data_inici,
     modalitat.`id` AS modalitat_id,
     modalitat.`description` AS modalitat_description,
     estadistica_modalitat.`soci_id` AS estadistica_modalitat_soci_id,
     estadistica_modalitat.`modalitat_id` AS estadistica_modalitat_modalitat_id,
     estadistica_modalitat.`coeficient_base` AS estadistica_modalitat_coeficient_base,
     ifnull(torneig.`data_finalitzacio`,'0000-00-00') as dataFinalitzacio,
     NOW() as 'data_actual'

FROM
     `soci` soci INNER JOIN `inscrit` inscrit ON soci.`id` = inscrit.`soci_id`
     INNER JOIN `torneig` torneig ON inscrit.`torneig_id` = torneig.`id`
     INNER JOIN `grup` grup ON inscrit.`grup_num` = grup.`num`
     AND torneig.`id` = grup.`torneig_id`
     INNER JOIN `modalitat` modalitat ON torneig.`modalitat_id` = modalitat.`id`
     INNER JOIN `estadistica_modalitat` estadistica_modalitat ON modalitat.`id` = estadistica_modalitat.`modalitat_id`
     AND soci.`id` = estadistica_modalitat.`soci_id`
WHERE
     torneig.id = $P{torneigId}
ORDER BY
     'qtat_victories' ASC]]>
	</queryString>
	<field name="qtat_victories" class="java.lang.Long"/>
	<field name="inscrit_soci_id" class="java.lang.Integer"/>
	<field name="inscrit_torneig_id" class="java.lang.Integer"/>
	<field name="inscrit_grup_num" class="java.lang.Integer"/>
	<field name="inscrit_data" class="java.sql.Timestamp"/>
	<field name="soci_id" class="java.lang.Integer"/>
	<field name="soci_nif" class="java.lang.String"/>
	<field name="soci_nom" class="java.lang.String"/>
	<field name="soci_cognom1" class="java.lang.String"/>
	<field name="soci_cognom2" class="java.lang.String"/>
	<field name="torneig_id" class="java.lang.Integer"/>
	<field name="torneig_nom" class="java.lang.String"/>
	<field name="torneig_modalitat_id" class="java.lang.Integer"/>
	<field name="grup_num" class="java.lang.Integer"/>
	<field name="grup_description" class="java.lang.String"/>
	<field name="grup_torneig_id" class="java.lang.Integer"/>
	<field name="torneig_data_inici" class="java.sql.Timestamp"/>
	<field name="modalitat_id" class="java.lang.Integer"/>
	<field name="modalitat_description" class="java.lang.String"/>
	<field name="estadistica_modalitat_soci_id" class="java.lang.Integer"/>
	<field name="estadistica_modalitat_modalitat_id" class="java.lang.Integer"/>
	<field name="estadistica_modalitat_coeficient_base" class="java.lang.Float"/>
<<<<<<< HEAD
	<field name="dataFinalitzacio" class="java.lang.String"/>
	<field name="data_actual" class="java.sql.Date"/>
=======
	<field name="ifnull(torneig.`data_finalitzacio`,0)" class="java.lang.String"/>
	<field name="data_actual" class="java.sql.Timestamp"/>
	<group name="Tornejos">
		<groupExpression><![CDATA[]]></groupExpression>
		<groupHeader>
			<band height="124">
				<staticText>
					<reportElement uuid="c0b87deb-99d4-488f-9c2d-de81409cf41f" x="0" y="12" width="90" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Nom torneig]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="94d97b27-d06c-46ce-8d6a-769b550e2185" x="0" y="32" width="90" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Data inici]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="caeb9bdf-f494-4138-a796-f667f3df2f01" x="0" y="52" width="90" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Modalitat]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="bb0d23ca-0ecd-43b7-97d3-ff8c2b8c889f" x="0" y="91" width="42" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Grups]]></text>
				</staticText>
				<line>
					<reportElement uuid="4d6adfbd-fbd6-4afb-bc46-5de09d8a1823" x="1" y="110" width="554" height="1"/>
				</line>
				<textField>
					<reportElement uuid="c5d1f43e-0e7a-4138-9b71-301403799225" x="100" y="12" width="160" height="20"/>
					<textElement verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{torneig_nom}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="8cfb2084-54d1-45b5-946d-fc881b1e0676" x="100" y="32" width="160" height="20"/>
					<textElement verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{torneig_data_inici}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="1c0a1ded-4937-419e-86e1-c0d09431c7f9" x="100" y="52" width="160" height="20"/>
					<textElement verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{modalitat_description}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="9624f447-09f8-400d-8d95-55790ec9031e" x="381" y="32" width="174" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
					<textFieldExpression><![CDATA[$F{ifnull(torneig.`data_finalitzacio`,0)} > $F{data_actual} ? $F{soci_nom} + " " + $F{soci_cognom1} + " " +  $F{soci_cognom2} : ""]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
>>>>>>> d1b35c8d5be8b5c75e21623d49495d6ec59ed8e3
	<group name="Grups">
		<groupExpression><![CDATA[]]></groupExpression>
	</group>
	<group name="Grup" isStartNewPage="true">
		<groupExpression><![CDATA[$F{grup_num}]]></groupExpression>
		<groupHeader>
			<band height="124" splitType="Prevent">
				<staticText>
					<reportElement uuid="61acc450-d9fe-42ba-899a-6b930f3d55a1" x="10" y="12" width="48" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Grup Nº :]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="62ad5741-571b-4b01-b27a-fafa9370d873" x="10" y="32" width="48" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Nom:]]></text>
				</staticText>
				<textField>
					<reportElement uuid="484a3583-86c1-4812-8db3-c99ab5ce2475" x="68" y="12" width="89" height="20"/>
					<textElement verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{grup_num} + 1]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="09d036ba-3f34-45eb-83b9-eb086592335f" x="68" y="32" width="176" height="20"/>
					<textElement verticalAlignment="Middle"/>
					<textFieldExpression><![CDATA[$F{grup_description}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="8e2f4b6c-e2dd-4cc5-bae4-be961deca050" x="88" y="94" width="58" height="20"/>
					<textElement>
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[Posició]]></text>
				</staticText>
				<line>
					<reportElement uuid="83eda621-49fd-4391-a84f-49d2eac33087" x="52" y="113" width="464" height="1"/>
				</line>
				<staticText>
<<<<<<< HEAD
					<reportElement uuid="3d2aa629-514f-4a54-9dc3-034cc57d5d60" x="381" y="94" width="116" height="20"/>
=======
					<reportElement uuid="8e2f4b6c-e2dd-4cc5-bae4-be961deca050" x="115" y="85" width="58" height="20"/>
>>>>>>> d1b35c8d5be8b5c75e21623d49495d6ec59ed8e3
					<textElement>
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[Partides guanyades]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="17b8fa46-f7b6-4bf4-adcd-05c6009885d9" x="151" y="93" width="218" height="20"/>
					<textElement textAlignment="Center">
						<font size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[ Nom i cognoms]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="5c1f2010-ca1b-4d82-8e50-49a7fc8e1e00" x="247" y="32" width="90" height="20">
						<printWhenExpression><![CDATA[("" + $F{data_actual}.getDate() + "-" + ($F{data_actual}.getMonth()+1) + "-" + ($F{data_actual}.getYear()+1900)) < $F{dataFinalitzacio}]]></printWhenExpression>
					</reportElement>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font size="13" isBold="true"/>
					</textElement>
					<text><![CDATA[Guanyador:]]></text>
				</staticText>
				<textField>
					<reportElement uuid="05dcd7fd-3217-4477-900d-78d9f4085245" x="337" y="32" width="179" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
					<textFieldExpression><![CDATA[("" + $F{data_actual}.getDate() + "-" + ($F{data_actual}.getMonth()+1) + "-" + ($F{data_actual}.getYear()+1900)) < $F{dataFinalitzacio} ? $F{soci_nom} + " " + $F{soci_cognom1} + " " +  $F{soci_cognom2} : ""]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<pageHeader>
		<band height="277">
			<staticText>
				<reportElement uuid="cd10925a-115e-43c8-89aa-e61d17afaa23" x="221" y="0" width="331" height="147"/>
				<textElement verticalAlignment="Middle">
					<font size="30"/>
				</textElement>
				<text><![CDATA[Classificació per Torneig]]></text>
			</staticText>
			<image>
				<reportElement uuid="2f5287c7-4314-401b-8b0d-b4d798a6e486" x="0" y="0" width="247" height="147"/>
<<<<<<< HEAD
				<imageExpression><![CDATA["repo:logo_billar.png"]]></imageExpression>
=======
				<imageExpression><![CDATA["logo_billar.png"]]></imageExpression>
>>>>>>> d1b35c8d5be8b5c75e21623d49495d6ec59ed8e3
			</image>
			<staticText>
				<reportElement uuid="c0b87deb-99d4-488f-9c2d-de81409cf41f" x="11" y="158" width="90" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Nom torneig]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="94d97b27-d06c-46ce-8d6a-769b550e2185" x="11" y="178" width="90" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Data inici]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="caeb9bdf-f494-4138-a796-f667f3df2f01" x="11" y="198" width="90" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Modalitat]]></text>
			</staticText>
			<textField>
				<reportElement uuid="c5d1f43e-0e7a-4138-9b71-301403799225" x="111" y="158" width="160" height="20"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{torneig_nom}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="8cfb2084-54d1-45b5-946d-fc881b1e0676" x="111" y="178" width="160" height="20"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{torneig_data_inici}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1c0a1ded-4937-419e-86e1-c0d09431c7f9" x="111" y="198" width="160" height="20"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{modalitat_description}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="bb0d23ca-0ecd-43b7-97d3-ff8c2b8c889f" x="10" y="246" width="42" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Grups]]></text>
			</staticText>
			<line>
				<reportElement uuid="4d6adfbd-fbd6-4afb-bc46-5de09d8a1823" x="7" y="266" width="545" height="1"/>
			</line>
		</band>
	</pageHeader>
	<detail>
		<band height="29" splitType="Stretch">
			<textField>
				<reportElement uuid="b350fe53-7b39-49d5-afb1-6f9d86f7b200" x="151" y="8" width="230" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None"/>
				<textFieldExpression><![CDATA[$F{soci_nom} + " " + $F{soci_cognom1} + " " +  $F{soci_cognom2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="dbbb7a5d-69a5-42b3-8e3e-d1ed51756de1" x="381" y="8" width="116" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{qtat_victories}]]></textFieldExpression>
			</textField>
			<textField>
<<<<<<< HEAD
				<reportElement uuid="88a1ba76-9dec-476f-bef2-fd0dd1bf3e24" x="104" y="9" width="42" height="20"/>
=======
				<reportElement uuid="88a1ba76-9dec-476f-bef2-fd0dd1bf3e24" x="115" y="8" width="42" height="20"/>
>>>>>>> d1b35c8d5be8b5c75e21623d49495d6ec59ed8e3
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="50">
			<textField pattern="dd/MM/yyyy">
				<reportElement uuid="8da0d892-45df-4801-9c2a-30796231168f" x="1" y="30" width="100" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="1b757d8d-2c52-420b-9c68-53d7b18729cd" x="432" y="30" width="80" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="f4ad0c1c-a90f-4fe7-82d0-746d8864e8ab" x="512" y="30" width="40" height="20"/>
				<textElement/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
